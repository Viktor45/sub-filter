[EN](README_en.md) / [RU](README.md)  / [ZH](README_zh.md) 

- [sub-filter](#sub-filter)
  - [–ß—Ç–æ —É–º–µ–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞?](#—á—Ç–æ-—É–º–µ–µ—Ç-–ø—Ä–æ–≥—Ä–∞–º–º–∞)
  - [–ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É?](#–∫–∞–∫-—Å–æ–±—Ä–∞—Ç—å-–ø—Ä–æ–≥—Ä–∞–º–º—É)
  - [–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å?](#–∫–∞–∫-–∑–∞–ø—É—Å—Ç–∏—Ç—å)
    - [–†–µ–∂–∏–º 1: HTTP-—Å–µ—Ä–≤–µ—Ä (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)](#—Ä–µ–∂–∏–º-1-http-—Å–µ—Ä–≤–µ—Ä-–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
      - [–ü—Ä–∏–º–µ—Ä —Å –ø–æ–ª–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏](#–ø—Ä–∏–º–µ—Ä-—Å-–ø–æ–ª–Ω—ã–º–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏)
      - [–ü—Ä–∏–º–µ—Ä —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏](#–ø—Ä–∏–º–µ—Ä-—Å-–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏)
    - [–†–µ–∂–∏–º 2: CLI (–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)](#—Ä–µ–∂–∏–º-2-cli-–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞—è-–æ–±—Ä–∞–±–æ—Ç–∫–∞)
      - [–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ CLI-—Ä–µ–∂–∏–º–µ:](#–Ω–æ–≤—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏-–≤-cli-—Ä–µ–∂–∏–º–µ)
      - [–ü—Ä–∏–º–µ—Ä: –≤—ã–≤–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª](#–ø—Ä–∏–º–µ—Ä-–≤—ã–≤–æ–¥-–≤-—Ç–µ—Ä–º–∏–Ω–∞–ª)
      - [–ü—Ä–∏–º–µ—Ä: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞](#–ø—Ä–∏–º–µ—Ä-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ-—Ñ–∞–π–ª–∞)
  - [–ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?](#—á—Ç–æ-–æ–∑–Ω–∞—á–∞—é—Ç-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
  - [–ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `--config` –∏ `--stdout`](#–Ω–æ–≤—ã–µ-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã---config-–∏---stdout)
    - [–§–ª–∞–≥ `--stdout` (—Ç–æ–ª—å–∫–æ –≤ CLI)](#—Ñ–ª–∞–≥---stdout-—Ç–æ–ª—å–∫–æ-–≤-cli)
    - [–§–ª–∞–≥ `--config`](#—Ñ–ª–∞–≥---config)
      - [–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ `config.yaml`:](#–ø—Ä–∏–º–µ—Ä-—Ñ–∞–π–ª–∞-configyaml)
  - [–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç?](#–∫–∞–∫-–ø—Ä–æ–≤–µ—Ä–∏—Ç—å-—á—Ç–æ-–≤—Å—ë-—Ä–∞–±–æ—Ç–∞–µ—Ç)
    - [–î–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞](#–¥–ª—è-—Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ-—Ä–µ–∂–∏–º–∞)
    - [–î–ª—è CLI-—Ä–µ–∂–∏–º–∞](#–¥–ª—è-cli-—Ä–µ–∂–∏–º–∞)
  - [–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–ª–∏–µ–Ω—Ç–µ?](#–∫–∞–∫-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å-–≤-–∫–ª–∏–µ–Ω—Ç–µ)
  - [–ì–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ –¥–ª—è Docker](#–≥–æ—Ç–æ–≤—ã–π-–æ–±—Ä–∞–∑-–¥–ª—è-docker)
  - [–ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å Docker-–æ–±—Ä–∞–∑?](#–∫–∞–∫-—Å–æ–±—Ä–∞—Ç—å-docker-–æ–±—Ä–∞–∑)
  - [–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ Docker?](#–∫–∞–∫-–∑–∞–ø—É—Å—Ç–∏—Ç—å-–≤-docker)
    - [–ß–µ—Ä–µ–∑ Docker](#—á–µ—Ä–µ–∑-docker)
    - [–ß–µ—Ä–µ–∑ Podman (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Docker)](#—á–µ—Ä–µ–∑-podman-–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞-docker)
  - [CLI-—Ä–µ–∂–∏–º –≤ Docker](#cli-—Ä–µ–∂–∏–º-–≤-docker)

# sub-filter

–ü—Ä–æ—Å—Ç–æ–π —Ñ–∏–ª—å—Ç—Ä –ø–æ–¥–ø–∏—Å–æ–∫

–≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ ‚Äî —É–º–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –¥–ª—è —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä—ã (VLESS, VMess, Trojan, Shadowsocks, Hysteria2). –û–Ω–∞ –±–µ—Ä—ë—Ç –ø—É–±–ª–∏—á–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Å –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏), –æ—Ç—Å–µ–∏–≤–∞–µ—Ç –≤—Å—ë –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –∏ –≤—ã–¥–∞—ë—Ç —á–∏—Å—Ç—ã–π, —Ä–∞–±–æ—á–∏–π —Å–ø–∏—Å–æ–∫ ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ Clash, Sing-Box, —Ä–æ—É—Ç–µ—Ä–∞—Ö –∏ –¥—Ä—É–≥–∏—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö.

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –æ —Ç–æ–º, –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ ‚Äî –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ [FAQ](FAQ.md).

 ‚ö†Ô∏è  –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ñ–ò–í–£–ß–ï–°–¢–¨ –ø—Ä–æ–∫—Å–µ–π, –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ https://github.com/kutovoys/xray-checker    

---

## –ß—Ç–æ —É–º–µ–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞?

‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏ —É–¥–∞–ª—è–µ—Ç –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏–ª–∏ —Å–ª–æ–º–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏  
‚úÖ –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–µ—Ä–≤–µ—Ä—ã –ø–æ —Å–ø–∏—Å–∫—É –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã)  
‚úÖ –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–µ ¬´–ª–æ–≤—É—à–∫–∏¬ª (—Ö–∞–Ω–∏–ø–æ—Ç—ã), –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–æ–≥–¥–∞ –ø–æ–ø–∞–¥–∞—é—Ç—Å—è –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–∫–∞—Ö  
‚úÖ –ö–µ—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî 30 –º–∏–Ω—É—Ç), —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–µ—Ç—å –∏ —Å–µ—Ä–≤–µ—Ä—ã  
‚úÖ –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É —Å –ø–æ–Ω—è—Ç–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–ø—É—Å–∫ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ñ–∞–π–ª–æ–º  
‚úÖ –ú–æ–∂–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–∑—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª (–≤ CLI-—Ä–µ–∂–∏–º–µ) –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

---

## –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É?

–ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Go (–≤–µ—Ä—Å–∏—è 1.25 –∏–ª–∏ –Ω–æ–≤–µ–µ), –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```
go build .
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ—è–≤–∏—Ç—Å—è —Ñ–∞–π–ª `sub-filter` ‚Äî —ç—Ç–æ –∏ –µ—Å—Ç—å –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞.

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å?

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã: **HTTP-—Å–µ—Ä–≤–µ—Ä** –∏ **CLI (–∫–æ–Ω—Å–æ–ª—å–Ω—ã–π)**.

### –†–µ–∂–∏–º 1: HTTP-—Å–µ—Ä–≤–µ—Ä (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ—Ä—Ç–∞. –ü–æ–¥–ø–∏—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è ¬´–Ω–∞ –ª–µ—Ç—É¬ª –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ.

#### –ü—Ä–∏–º–µ—Ä —Å –ø–æ–ª–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```
./sub-filter 8000 1800 ./config/sub.txt ./config/bad.txt ./config/uagent.txt
```

#### –ü—Ä–∏–º–µ—Ä —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```
./sub-filter 8000
```

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ:
- –ö–µ—à –∂–∏–≤—ë—Ç 1800 —Å–µ–∫—É–Ω–¥ (30 –º–∏–Ω—É—Ç)  
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∏—â–µ—Ç —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ `./config/`  
- –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É—Å—Ç—ã–µ —Å–ø–∏—Å–∫–∏ (–ø–æ–¥–ø–∏—Å–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π)

### –†–µ–∂–∏–º 2: CLI (–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –ø–æ–¥–ø–∏—Å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã `sub-filter-cache`, —Ç–æ—á–Ω—ã–π –ø—É—Ç—å –∫ –∫–æ—Ç–æ—Ä–æ–π –ø–∏—à–µ—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, cron-–∑–∞–¥–∞—á –∏–ª–∏ –æ—Ñ—Ñ–ª–∞–π–Ω-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

#### –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ CLI-—Ä–µ–∂–∏–º–µ:

- **`--stdout`** ‚Äî –≤–º–µ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª—ã, –≤—ã–≤–æ–¥–∏—Ç –≤—Å—ë –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª  
- **`--config`** ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ

#### –ü—Ä–∏–º–µ—Ä: –≤—ã–≤–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª

```
./sub-filter --cli --stdout
```

–í—ã —Å—Ä–∞–∑—É —É–≤–∏–¥–∏—Ç–µ –≥–æ—Ç–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤.

#### –ü—Ä–∏–º–µ—Ä: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

```
./sub-filter --cli --config ./my-config.yaml
```

---

## –ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?

| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –û–ø–∏—Å–∞–Ω–∏–µ                                                                               |
| ------------ | -------------------------------------------------------------------------------------- |
| `8000`       | –ü–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–µ—Ä–≤–µ—Ä (—Ç–æ–ª—å–∫–æ –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º —Ä–µ–∂–∏–º–µ)                     |
| `1800`       | –í—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–µ—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (1800 = 30 –º–∏–Ω—É—Ç)                                       |
| `sub.txt`    | –°–ø–∏—Å–æ–∫ URL-–ø–æ–¥–ø–∏—Å–æ–∫ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)                                              |
| `bad.txt`    | –°–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è –≤–∫–ª—é—á–∞—Ç—å –≤ –ø–æ–¥–ø–∏—Å–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã)            |
| `uagent.txt` | –ö–∞–∫–∏–µ –∫–ª–∏–µ–Ω—Ç—ã (User-Agent) –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Clash`, `Shadowrocket`) |

> üí° –ï—Å–ª–∏ –≤—ã –Ω–µ —É–∫–∞–∂–µ—Ç–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –∏—Ö –≤ –ø–∞–ø–∫–µ `./config/`.  
> –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É, –Ω–æ –±–µ–∑ —ç—Ç–∏—Ö –ø—Ä–∞–≤–∏–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `bad.txt`).

---

## –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `--config` –∏ `--stdout`

### –§–ª–∞–≥ `--stdout` (—Ç–æ–ª—å–∫–æ –≤ CLI)

–í–º–µ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ñ–∞–π–ª—ã `mod_1.txt`, `mod_2.txt` –∏ —Ç.–¥., –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≤–µ–¥–µ—Ç –≤—Å—ë –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª. –≠—Ç–æ —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ –í—ã —Ö–æ—Ç–∏—Ç–µ —Å—Ä–∞–∑—É —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ—ë –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ.

–ü—Ä–∏–º–µ—Ä:

```
./sub-filter --cli --stdout > my-sub.txt
```

### –§–ª–∞–≥ `--config`

–ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å **–≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ**. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç **YAML, JSON –∏–ª–∏ TOML**.

#### –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ `config.yaml`:

```yaml
sources_file: "./config/sub.txt"
rules_file: "./config/rules.yaml"
bad_words_file: "./config/bad.txt"
uagent_file: "./config/uagent.txt"
cache_dir: "/tmp/sub-filter-cache"
cache_ttl: 1800s
allowed_ua:
  - "Clash"
  - "happ"
bad_words:
  - "tracking"
  - "fake"

```

–ï—Å–ª–∏ –í—ã –Ω–µ —É–∫–∞–∂–µ—Ç–µ –∫–∞–∫–æ–µ-—Ç–æ –ø–æ–ª–µ ‚Äî –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

| –ü–æ–ª–µ             | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é             |
| ---------------- | --------------------------------- |
| `cache_ttl`      | `1800` (30 –º–∏–Ω—É—Ç)                 |
| `sources_file`   | `"./config/sub.txt"`              |
| `bad_words_file` | `"./config/bad.txt"`              |
| `uagent_file`    | `"./config/uagent.txt"`           |
| `cache_dir`      | `/tmp/sub-filter-cache` (–≤ Linux) |

> üí° –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –æ—Å–æ–±–µ–Ω–Ω–æ —É–¥–æ–±–µ–Ω –≤ Docker –∏–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ systemd.

---

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –î–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É –∏–∑ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ —Ñ–∞–π–ª–∞ `sub.txt`:

```
curl -H "User-Agent: Clash" "http://localhost:8000/filter?id=1"
```

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Äî –≤—ã —É–≤–∏–¥–∏—Ç–µ ¬´—á–∏—Å—Ç—É—é¬ª –ø–æ–¥–ø–∏—Å–∫—É.

> üí° –°–æ–≤–µ—Ç: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Clash`) –µ—Å—Ç—å –≤ —Ñ–∞–π–ª–µ `uagent.txt` ‚Äî —Ç–∞–∫ –ø–æ–¥–ø–∏—Å–∫–∞ —Ç–æ—á–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è.

### –î–ª—è CLI-—Ä–µ–∂–∏–º–∞

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å `--cli` –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–ø–∫–∏ `sub-filter-cache`:

```
./sub-filter --cli
```

–í—ã —É–≤–∏–¥–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–µ—Ä.

–ò–ª–∏ —Å—Ä–∞–∑—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª:

```
./sub-filter --cli --stdout
```

---

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–ª–∏–µ–Ω—Ç–µ?

–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–¥–ø–∏—Å–∫—É –≤–∏–¥–∞:

```
http://—Å–µ—Ä–≤–µ—Ä:–ø–æ—Ä—Ç/filter?id=–Ω–æ–º–µ—Ä
```

–ó–∞–º–µ–Ω–∏—Ç–µ:
- `—Å–µ—Ä–≤–µ—Ä` ‚Üí IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞, Raspberry Pi –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞  
- `–ø–æ—Ä—Ç` ‚Üí –ø–æ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —É–∫–∞–∑–∞–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `8000`)  
- `–Ω–æ–º–µ—Ä` ‚Üí –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ `sub.txt` —Å –Ω—É–∂–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ = `id=1`)

> üîí –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –∑–∞ reverse proxy —Å HTTPS (–Ω–∞–ø—Ä–∏–º–µ—Ä, Nginx, Caddy –∏–ª–∏ Cloudflare), –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø –≤–æ–∑–º–æ–∂–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.

---

## –ì–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ –¥–ª—è Docker

–î–æ—Å—Ç—É–ø–µ–Ω —Ç–∞–∫ –¥–ª—è linux `amd64` –∏ `arm64`, —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º [ko](.ko.yaml)

```
ghcr.io/viktor45/sub-filter:latest
```


## –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å Docker-–æ–±—Ä–∞–∑?

–°–æ–±–∏—Ä–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω–æ, –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º `Dockerfile`

```
docker build -t sub-filter .
```

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ Docker?

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø—É—Ç—å `/tmp/sub-filter-cache` —ç—Ç–æ –¥–ª—è `distroless` —Å–±–æ—Ä–∫–∏ –≤ `Dockerfile` 

### –ß–µ—Ä–µ–∑ Docker

```
docker run -d \
  --name sub-filter \
  -p 8000:8000 \
  -v $(pwd)/config:/config:ro \
  -v $(pwd)/cache:/tmp/sub-filter-cache:rw \
  sub-filter \
  8000 1800
```

### –ß–µ—Ä–µ–∑ Podman (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Docker)

```
podman run -d --replace \
  --name sub-filter \
  -p 8000:8000 \
  -v $(pwd)/config:/config:ro,z \
  -v $(pwd)/cache:/tmp/sub-filter-cache:rw,z \
  sub-filter \
  8000 1800
```

> üìÅ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–ø–∫–∏ `./config` –∏ `./cache` —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:
> ```
> mkdir -p ./config ./cache
> ```

---

## CLI-—Ä–µ–∂–∏–º –≤ Docker

–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ Docker:

```
docker run --rm \
  -v $(pwd)/config:/config:ro \
  -v $(pwd)/cache:/tmp/sub-filter-cache:rw \
  sub-filter \
  --cli 1800
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ `./cache`.

–ò–ª–∏ —Å—Ä–∞–∑—É –≤—ã–≤–µ—Å—Ç–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª:

```
docker run --rm \
  -v $(pwd)/config:/config:ro \
  -v $(pwd)/cache:/tmp/sub-filter-cache:rw \
  sub-filter \
  --cli --stdout
```