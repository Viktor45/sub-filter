- [sub-filter](#sub-filter)
  - [–ß—Ç–æ —É–º–µ–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞?](#—á—Ç–æ-—É–º–µ–µ—Ç-–ø—Ä–æ–≥—Ä–∞–º–º–∞)
  - [–ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É?](#–∫–∞–∫-—Å–æ–±—Ä–∞—Ç—å-–ø—Ä–æ–≥—Ä–∞–º–º—É)
  - [–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å?](#–∫–∞–∫-–∑–∞–ø—É—Å—Ç–∏—Ç—å)
    - [–ü—Ä–∏–º–µ—Ä —Å –ø–æ–ª–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏](#–ø—Ä–∏–º–µ—Ä-—Å-–ø–æ–ª–Ω—ã–º–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏)
    - [–ü—Ä–∏–º–µ—Ä —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏](#–ø—Ä–∏–º–µ—Ä-—Å-–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏)
  - [–ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?](#—á—Ç–æ-–æ–∑–Ω–∞—á–∞—é—Ç-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
  - [–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç?](#–∫–∞–∫-–ø—Ä–æ–≤–µ—Ä–∏—Ç—å-—á—Ç–æ-–≤—Å—ë-—Ä–∞–±–æ—Ç–∞–µ—Ç)
    - [–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–ª–∏–µ–Ω—Ç–µ?](#–∫–∞–∫-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å-–≤-–∫–ª–∏–µ–Ω—Ç–µ)
  - [–ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å Docker-–æ–±—Ä–∞–∑?](#–∫–∞–∫-—Å–æ–±—Ä–∞—Ç—å-docker-–æ–±—Ä–∞–∑)
  - [–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ Docker?](#–∫–∞–∫-–∑–∞–ø—É—Å—Ç–∏—Ç—å-–≤-docker)
    - [–ß–µ—Ä–µ–∑ Docker](#—á–µ—Ä–µ–∑-docker)
    - [–ß–µ—Ä–µ–∑ Podman (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Docker)](#—á–µ—Ä–µ–∑-podman-–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞-docker)

# sub-filter

–ü—Ä–æ—Å—Ç–æ–π —Ñ–∏–ª—å—Ç—Ä –ø–æ–¥–ø–∏—Å–æ–∫

–≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ ‚Äî —É–º–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –¥–ª—è —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä—ã (VLESS, VMess, Trojan, Shadowsocks). –û–Ω–∞ –±–µ—Ä—ë—Ç –ø—É–±–ª–∏—á–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Å –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏), –æ—Ç—Å–µ–∏–≤–∞–µ—Ç –≤—Å—ë –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –∏ –≤—ã–¥–∞—ë—Ç —á–∏—Å—Ç—ã–π, —Ä–∞–±–æ—á–∏–π —Å–ø–∏—Å–æ–∫ ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ Clash, Sing-Box, —Ä–æ—É—Ç–µ—Ä–∞—Ö –∏ –¥—Ä—É–≥–∏—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö.

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –æ —Ç–æ–º, –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ ‚Äî –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ [FAQ](FAQ.md).

---

## –ß—Ç–æ —É–º–µ–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞?

‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏ —É–¥–∞–ª—è–µ—Ç –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏–ª–∏ —Å–ª–æ–º–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏  
‚úÖ –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–µ—Ä–≤–µ—Ä—ã –ø–æ —Å–ø–∏—Å–∫—É –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã)  
‚úÖ –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–µ ¬´–ª–æ–≤—É—à–∫–∏¬ª (—Ö–∞–Ω–∏–ø–æ—Ç—ã), –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–æ–≥–¥–∞ –ø–æ–ø–∞–¥–∞—é—Ç—Å—è –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–∫–∞—Ö  
‚úÖ –ö–µ—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî 30 –º–∏–Ω—É—Ç), —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–µ—Ç—å –∏ —Å–µ—Ä–≤–µ—Ä—ã  
‚úÖ –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É —Å –ø–æ–Ω—è—Ç–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º

---

## –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É?

–ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Go (–≤–µ—Ä—Å–∏—è 1.21 –∏–ª–∏ –Ω–æ–≤–µ–µ), –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```
go build -o filter .
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ—è–≤–∏—Ç—Å—è —Ñ–∞–π–ª `filter` ‚Äî —ç—Ç–æ –∏ –µ—Å—Ç—å –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞.

> üí° –ï—Å–ª–∏ –≤—ã –≤–ø–µ—Ä–≤—ã–µ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–º ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É —Ü–µ–ª–∏–∫–æ–º. –í—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç!

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å?

### –ü—Ä–∏–º–µ—Ä —Å –ø–æ–ª–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```
./filter 8000 1800 ./config/sub.txt ./config/bad.txt ./config/uagent.txt
```

### –ü—Ä–∏–º–µ—Ä —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```
./filter 8000 1800
```

(–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ `./config/`)

---

## –ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?

| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –û–ø–∏—Å–∞–Ω–∏–µ                                                                               |
| ------------ | -------------------------------------------------------------------------------------- |
| `8000`       | –ü–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–µ—Ä–≤–µ—Ä (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)                                |
| `1800`       | –í—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–µ—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (1800 = 30 –º–∏–Ω—É—Ç)                                       |
| `sub.txt`    | –°–ø–∏—Å–æ–∫ URL-–ø–æ–¥–ø–∏—Å–æ–∫ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)                                              |
| `bad.txt`    | –°–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è –≤–∫–ª—é—á–∞—Ç—å –≤ –ø–æ–¥–ø–∏—Å–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã)            |
| `uagent.txt` | –ö–∞–∫–∏–µ –∫–ª–∏–µ–Ω—Ç—ã (User-Agent) –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Clash`, `Shadowrocket`) |

> üí° –ï—Å–ª–∏ –≤—ã –Ω–µ —É–∫–∞–∂–µ—Ç–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –∏—Ö –≤ –ø–∞–ø–∫–µ `./config/`.

---

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç?

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É –∏–∑ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ —Ñ–∞–π–ª–∞ `sub.txt`:

```
curl -H "User-Agent: Clash" "http://localhost:8000/filter?id=1"
```

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Äî –≤—ã —É–≤–∏–¥–∏—Ç–µ ¬´—á–∏—Å—Ç—É—é¬ª –ø–æ–¥–ø–∏—Å–∫—É.

> üí° –°–æ–≤–µ—Ç: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Clash`) –µ—Å—Ç—å –≤ —Ñ–∞–π–ª–µ `uagent.txt` ‚Äî —Ç–∞–∫ –ø–æ–¥–ø–∏—Å–∫–∞ —Ç–æ—á–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è.

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–ª–∏–µ–Ω—Ç–µ?

–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–¥–ø–∏—Å–∫—É –≤–∏–¥–∞:

```
http://—Å–µ—Ä–≤–µ—Ä:–ø–æ—Ä—Ç/filter?id=–Ω–æ–º–µ—Ä
```

–ó–∞–º–µ–Ω–∏—Ç–µ:
- `—Å–µ—Ä–≤–µ—Ä` ‚Üí IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞, Raspberry Pi –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞  
- `–ø–æ—Ä—Ç` ‚Üí –ø–æ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —É–∫–∞–∑–∞–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `8000`)  
- `–Ω–æ–º–µ—Ä` ‚Üí –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ `sub.txt` —Å –Ω—É–∂–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ = `id=1`)

> üîí –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –∑–∞ reverse proxy —Å HTTPS (–Ω–∞–ø—Ä–∏–º–µ—Ä, Nginx, Caddy –∏–ª–∏ Cloudflare), –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø –≤–æ–∑–º–æ–∂–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.

---

## –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å Docker-–æ–±—Ä–∞–∑?

```
docker build -t sub-filter .
```

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ Docker?

### –ß–µ—Ä–µ–∑ Docker

```
docker run -d \
  --name sub-filter \
  -p 8000:8000 \
  -v $(pwd)/config:/config:ro \
  -v $(pwd)/cache:/cache:rw \
  sub-filter \
  8000 1800
```

### –ß–µ—Ä–µ–∑ Podman (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Docker)

```
podman run -d --replace \
  --name sub-filter \
  -p 8000:8000 \
  -v $(pwd)/config:/config:ro,z \
  -v $(pwd)/cache:/cache:rw,z \
  sub-filter \
  8000 1800
```

> üìÅ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–ø–∫–∏ `./config` –∏ `./cache` —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:
> ```
> mkdir -p ./config ./cache
> ```

---

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–ø–æ–∫–æ–π–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∏—Å—Ç—ã–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∞–º–∞!
